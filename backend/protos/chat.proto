syntax = "proto3";

package chat;

import "game.proto";

message ChatMessage {
  string user = 1;        // 发送者用户名
  int32 room_id = 2;      // 房间号
  string content = 3;     // 文本内容
  int64 timestamp = 4;    // 发送时间，毫秒
  MessageType type = 5;   // 消息类型
}

enum MessageType {
  UNKNOWN = 0;
  SYSTEM = 1;   // 系统提示（加入/离开）
  USER_TEXT = 2; // 用户文本
  QUERY_COUNT = 3; // 查询房间人数
  ROOM_COUNT = 4;  // 房间人数响应
  MUSIC = 5;    // 音乐消息
  DRAWING = 6;  // 画图数据（画布内容）
  DRAWING_REQUEST = 7; // 申请成为画画人
  DRAWING_CLEAR = 8; // 清空画布
  DRAWING_STATE = 9; // 画图状态（当前画画人信息）
  DRAWING_STOP = 10; // 退出画画
  DRAWING_REQUEST_APPROVE = 11; // 同意画画申请
}

// WebSocket 顶层封包：统一封装聊天和游戏消息
message WsEnvelope {
  oneof payload {
    ChatMessage chat = 1;
    livewar.GameMessage game = 2;
  }
}

